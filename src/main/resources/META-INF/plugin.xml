<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <version>0.2.0</version>

    <id>io.github.ceracharlescc.copy4lm</id>
    <depends>com.intellij.modules.platform</depends>
    <depends optional="true" config-file="copy4lm-withVcs.xml">com.intellij.modules.vcs</depends>

    <name>Copy 4 LM</name>
    <vendor email="ceracharlescc@proton.me" url="https://github.com/CeraCharlesCC">C.C.</vendor>

    <!-- https://plugins.jetbrains.com/docs/marketplace/best-practices-for-listing.html -->
    <description><![CDATA[
    <p>Copy4LM is a plugin that enables quick copying of selected file or directory contents to the clipboard in a customizable format tailored for LLMs (Large Language Models), allowing for rapid contextualization of any part of a codebase.</p>
    <h2>This plugin is useful for:</h2>
    <ul>
        <li>Developers who frequently need to share their code via chat applications.</li>
        <li>Developers who need to copy their code to build context for LLM apps like GPT-5.2 Pro, Gemini 3 Deepthink</li>
    </ul>
    <h2>Main features:</h2>
    <ul>
        <li>Copy the content of multiple files or directories to the clipboard.</li>
        <li>Customizable text structure, including pre-text, file header text, and post-text.</li>
        <li>Configurable file copying constraints (default is 30 files) to prevent memory issues with larger folders.</li>
        <li>Optional file extension filters to specify which files should be copied.</li>
        <li>Information on the copied items, including the number of files copied, total lines, total words, and an estimate of tokens (considering words and punctuation).</li>
    </ul>
    <h2>Credits</h2>
    <p>This plugin is based on mwguerra's copy-file-content (under MIT License) plugin, available at: <a href="https://github.com/mwguerra/copy-file-content/">here</a>. Thank you mwguerra for the inspiration and foundation!</p>
    ]]>
    </description>

    <change-notes>
        <![CDATA[
        <h3>Version 0.2.0 Changes:</h3>
        <h4>⚠️ Breaking changes</h4>
        <ul>
        <li>Update placeholder syntax to use double dollar signs (e.g., `$$&quot;$PROJECT_NAME&quot;`) to avoid string interpolation issues; existing templates must be updated.</li>
        </ul>
        <h4>Added</h4>
        <ul>
        <li>Add directory structure copy feature to copy a tree view of selected directories/files (#2).</li>
        <li>Add `$DIRECTORY_STRUCTURE` placeholder for formatting.</li>
        <li>Split settings UI into separate panels for File Content and Directory Structure.</li>
        </ul>
        <h4>Changed</h4>
        <ul>
        <li>Replace AWT clipboard with IntelliJ platform clipboard integration.</li>
        <li>Update plugin description to clarify LLM context formatting.</li>
        <li>Improve internal domain model structure and encapsulation.</li>
        </ul>
        <h4>Internal</h4>
        <ul>
        <li>Add GitHub Actions CI workflow.</li>
        <li>Add unit tests for `CopyFilesInteractor` and `FileCollector`.</li>
        <li>Refactor copy logic into `CopyFilesInteractor` and `FileCollector`.</li>
        </ul>
        ]]>
    </change-notes>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="Copy 4 LM" displayType="BALLOON" isLogByDefault="true" />

        <!-- Parent configurable -->
        <projectConfigurable
            id="Copy4LMConfigurable"
            displayName="Copy 4 LM Settings"
            instance="io.github.ceracharlescc.copy4lm.ui.settings.Copy4LMConfigurable"/>

        <!-- Child: Copy File Content to Clipboard -->
        <projectConfigurable
            id="CopyFileContentConfigurable"
            parentId="Copy4LMConfigurable"
            displayName="Copy File Content to Clipboard"
            instance="io.github.ceracharlescc.copy4lm.ui.settings.CopyFileContentConfigurable"/>

        <!-- Child: Copy Directory Structure to Clipboard -->
        <projectConfigurable
            id="CopyDirectoryStructureConfigurable"
            parentId="Copy4LMConfigurable"
            displayName="Copy Directory Structure to Clipboard"
            instance="io.github.ceracharlescc.copy4lm.ui.settings.CopyDirectoryStructureConfigurable"/>
    </extensions>
    <actions>
        <!-- For general IntelliJ IDEs -->
        <action id="CopyFileContentContentsAction"
                class="io.github.ceracharlescc.copy4lm.ui.CopyFileContentAction"
                text="Copy File Content to Clipboard"
                description="Copy folder and file content to the clipboard.">
            <add-to-group group-id="CutCopyPasteGroup" anchor="after" relative-to-action="CopyPaths"/>
        </action>
        <action id="CopyAllOpenTabsAction"
                class="io.github.ceracharlescc.copy4lm.ui.CopyAllOpenTabsAction"
                text="Copy All Open Tabs Content to Clipboard"
                description="Copy the content of all open editor tabs to the clipboard.">
            <add-to-group group-id="EditorTabPopupMenu" anchor="after" relative-to-action="CopyPaths"/>
        </action>
        <action id="CopyDirectoryStructureAction"
                class="io.github.ceracharlescc.copy4lm.ui.CopyDirectoryStructureAction"
                text="Copy Directory Structure to Clipboard"
                description="Copy a tree view of selected directories/files to the clipboard.">
            <add-to-group group-id="CutCopyPasteGroup" anchor="after" relative-to-action="CopyFileContentContentsAction"/>
        </action>

        <!-- For Rider -->
        <action id="CopyFileContentContentsActionRider"
                class="io.github.ceracharlescc.copy4lm.ui.CopyFileContentAction"
                text="Copy File Content to Clipboard"
                description="Copy folder and file content to the clipboard.">
            <add-to-group group-id="CopyReferencePopupGroup" anchor="after" relative-to-action="CopyPaths"/>
        </action>
        <action id="CopyDirectoryStructureActionRider"
                class="io.github.ceracharlescc.copy4lm.ui.CopyDirectoryStructureAction"
                text="Copy Directory Structure to Clipboard"
                description="Copy a tree view of selected directories/files to the clipboard.">
            <add-to-group group-id="CopyReferencePopupGroup" anchor="after" relative-to-action="CopyFileContentContentsActionRider"/>
        </action>
    </actions>
</idea-plugin>
